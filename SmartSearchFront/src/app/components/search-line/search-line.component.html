<div class="search-container">
  <div class="search-box">
    <input 
      #searchInput
      type="text" 
      [(ngModel)]="searchTerm" 
      placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞..."
      class="search-input"
      (keyup.enter)="onSearch()"
      (focus)="showSuggestions = hasSuggestions()"
    />
    
    <button 
      (click)="onSearch()" 
      class="search-btn"
      [disabled]="searchTerm.trim().length === 0"
    >
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
    </button>
    
    <button 
      *ngIf="searchTerm" 
      (click)="clearSearch()" 
      class="clear-btn"
    >
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
      </svg>
    </button>
  </div>

  <!-- –í—ã–ø–∞–¥–∞—é—â–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ -->
  <div class="suggestions-dropdown" *ngIf="showSuggestions && hasSuggestions()">
    <div class="suggestions-loading" *ngIf="isLoading">
      –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫...
    </div>

    <!-- –†–µ–µ—Å—Ç—Ä–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ -->
    <div 
      *ngFor="let suggestion of suggestions.registry_records; let i = index" 
      class="suggestion-item"
      [class.selected]="i === selectedSuggestionIndex"
      (click)="selectSuggestion(suggestion)"
      (mouseenter)="selectedSuggestionIndex = i"
    >
      <div class="suggestion-icon">
        üìÑ
      </div>
      <div class="suggestion-content">
        <div class="suggestion-title">
          {{ suggestion.hintType === 1 ? '–ö–æ–Ω—Ç—Ä–∞–∫—Ç' : '–ö–°' }}
        </div>
        <div class="suggestion-preview">
          {{ getSuggestionText(suggestion)}}
        </div>
      </div>
    </div>

    <!-- –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π -->
    <div 
      *ngFor="let suggestion of suggestions.knowledge_base_articles; let i = index" 
      class="suggestion-item"
      [class.selected]="i + suggestions.registry_records.length === selectedSuggestionIndex"
      (click)="selectSuggestion(suggestion)"
      (mouseenter)="selectedSuggestionIndex = i + suggestions.registry_records.length"
    >
      <div class="suggestion-icon">
        üìö
      </div>
      <div class="suggestion-content">
        <div class="suggestion-title">–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</div>
        <div class="suggestion-preview">{{ suggestion.text }}</div>
      </div>
    </div>

    <!-- –î–µ–π—Å—Ç–≤–∏—è -->
    <div 
      *ngIf="suggestions.intents" 
      class="suggestion-item"
      [class.selected]="selectedSuggestionIndex === getTotalSuggestionsCount() - 1"
      (click)="selectSuggestion(suggestions.intents)"
      (mouseenter)="selectedSuggestionIndex = getTotalSuggestionsCount() - 1"
    >
      <div class="suggestion-icon">
        ‚ö°
      </div>
      <div class="suggestion-content">
        <div class="suggestion-title">–î–µ–π—Å—Ç–≤–∏–µ</div>
        <div class="suggestion-preview">{{ suggestions.intents.name }}</div>
      </div>
    </div>
  </div>

  <!-- –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
  <div *ngIf="debugInfo" class="debug-info">
    –ù–∞–π–¥–µ–Ω–æ: —Ä–µ–µ—Å—Ç—Ä: {{ debugInfo.registry }}, –±–∞–∑–∞: {{ debugInfo.knowledge }}, –¥–µ–π—Å—Ç–≤–∏—è: {{ debugInfo.intents }}
  </div>
</div>